# Development Dockerfile with hot reload
FROM golang:1.21-alpine AS dev

WORKDIR /app

# Install development tools
RUN apk add --no-cache git make bash

# Install Air for live reloading
RUN go install github.com/cosmtrek/air@latest

# Install golangci-lint for linting
RUN wget -O- -nv https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh | sh -s latest

# Copy go mod files first for better caching
COPY go.mod go.sum ./
RUN go mod download

# Copy source code (will be overridden by volume in dev mode)
COPY . .

# Expose port
EXPOSE 8080

# Default command (can be overridden in docker-compose.dev.yml)
CMD ["go", "run", "main.go"]

